<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____1172026485']= array(base64_decode('aXNfc'.'3R'.'yaW5n'),base64_decode('c3Ryd'.'G9sb3'.'dlcg'.'=='),base64_decode('aX'.'N'.'f'.'Y'.'XJ'.'yYXk='),base64_decode('aXNfc3RyaW5n'),base64_decode(''.'Z3'.'p'.'kZWNvZGU'.'='),base64_decode('YmFzZTY0X'.'2R'.'l'.'Y'.'29kZQ='.'='),base64_decode('dXJsZGVjb2R'.'l'),base64_decode('YXJyY'.'XlfcmV'.'2'.'Z'.'XJzZQ=='),base64_decode('Z3pl'.'bmNvZ'.'GU='),base64_decode('Ym'.'FzZTY0'.'X2VuY'.'29kZ'.'Q=='),base64_decode('dXJsZW'.'5'.'jb2Rl'),base64_decode('YmluMmhl'.'eA=='),base64_decode('a'.'X'.'NfYXJyYXk='),base64_decode('c3RydG9sb3dlcg=='),base64_decode('aXNfYX'.'J'.'yYXk='),base64_decode('am9p'.'b'.'g='.'='),base64_decode(''.'Zm'.'5tYXRja'.'A=='),base64_decode('cmF3dXJsZGVjb'.'2'.'Rl'),base64_decode('c3Vi'.'c3Ry'),base64_decode('c3Vic3Ry'),base64_decode('c3Ry'.'X3JlcGxhY2U='),base64_decode(''.'cH'.'Jl'.'Z'.'1'.'9'.'xd'.'W9'.'0'.'ZQ='.'='),base64_decode(''.'c'.'H'.'JlZ19'.'tYX'.'RjaA=='));if(!function_exists(__NAMESPACE__.'\\___691579823')){function ___691579823($_159063180){static $_1891548011= false; if($_1891548011 == false) $_1891548011=array('YW'.'N0aW9u','aW'.'50dmF'.'s','cGF0aA='.'=','Y29'.'u'.'dGV4'.'dA==',''.'a2V5c'.'w==','cH'.'JvY2Vzcw='.'=','Z'.'W'.'5jb2R'.'p'.'bmc=','c'.'HJlZ19yZXBsY'.'W'.'N'.'l','cGF'.'0aA==','Y29udGV'.'4dA==',''.'a'.'2V5cw==',''.'cHJvY2Vzcw==','ZW5jb2Rpbm'.'c=','cGF0dGVybg==','cHJlZ19tYXRjaA'.'==','c'.'G'.'F0'.'aA==','Y'.'29ud'.'GV4'.'dA==','a2V'.'5'.'cw==',''.'cHJvY'.'2'.'Vzc'.'w==','Z'.'W5j'.'b'.'2Rpbmc=','cGF'.'0dGVybg==','cG'.'9'.'zdF9h'.'Y3R'.'pb24=','Y'.'2hlY2tfY3NyZg='.'=','cGF0'.'aA==',''.'Y29udG'.'V4d'.'A'.'==','a2V5c'.'w'.'==','cHJv'.'Y2V'.'zcw==','Z'.'W5'.'jb2Rpbmc=','cGF0dGV'.'ybg==','YW'.'N0aW'.'9u','Y'.'WN0'.'aW9u',''.'YW'.'N0aW9u','YW'.'N0'.'aW9u','YWN'.'0aW9u',''.'YW'.'N0aW'.'9u','cG9z'.'d'.'F'.'9hY3Rpb'.'24'.'=','ZW5jb2R'.'p'.'bmc=','Z'.'W'.'5jb2'.'Rp'.'bm'.'c=','ZW5j'.'b'.'2Rpbmc=','ZW5j'.'b'.'2R'.'pbmc=','Z'.'W5'.'jb'.'2Rpb'.'mc'.'=',''.'ZW'.'5j'.'b2Rp'.'bmc=','Z3o=','YmF'.'zZTY'.'0','dXJs','aGV4','L'.'g==','Lw==','aW'.'5k'.'ZXgucGhw',''.'L2luZGV4LnBo'.'cA='.'=','U0N'.'S'.'SVBUX'.'05BTUU=','L2luZGV4LnBocA==','U'.'0NSSVBUX05BTUU=',''.'U'.'0NSSVBUX05'.'BTUU=','U0'.'N'.'SSVBU'.'X'.'05BTUU=','fg==','fl4=','fg==',''.'XH4=',''.'JH4=');return base64_decode($_1891548011[$_159063180]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_1713387776; protected $_1327153155; protected $_1141115044; protected $_38751261; protected $_86970768; public static function make(array $_1847564510):?static{ $_1847564510= static::prepareRuleParameters($_1847564510); return match($_1847564510[___691579823(0)]){ ___691579823(1) => new IntvalRule( $_1847564510[___691579823(2)], $_1847564510[___691579823(3)], $_1847564510[___691579823(4)], $_1847564510[___691579823(5)], $_1847564510[___691579823(6)]), ___691579823(7) => new PregReplaceRule( $_1847564510[___691579823(8)], $_1847564510[___691579823(9)], $_1847564510[___691579823(10)], $_1847564510[___691579823(11)], $_1847564510[___691579823(12)], $_1847564510[___691579823(13)]), ___691579823(14) => new PregMatchRule( $_1847564510[___691579823(15)], $_1847564510[___691579823(16)], $_1847564510[___691579823(17)], $_1847564510[___691579823(18)], $_1847564510[___691579823(19)], $_1847564510[___691579823(20)], $_1847564510[___691579823(21)]), ___691579823(22) => new CsrfRule( $_1847564510[___691579823(23)], $_1847564510[___691579823(24)], $_1847564510[___691579823(25)], $_1847564510[___691579823(26)], $_1847564510[___691579823(27)], $_1847564510[___691579823(28)],), default => null,};} protected static function prepareRuleParameters(array $_1095616576): array{ if($GLOBALS['____1172026485'][0]($_1095616576[___691579823(29)])){ $_1095616576[___691579823(30)]= $GLOBALS['____1172026485'][1]($_1095616576[___691579823(31)]);} elseif($GLOBALS['____1172026485'][2]($_1095616576[___691579823(32)])){ $_1442813426= $_1095616576[___691579823(33)]; $_1095616576[___691579823(34)]= $_1442813426[(241*2-482)]; $_1095616576[___691579823(35)]= $_1442813426[round(0+0.2+0.2+0.2+0.2+0.2)];} $_1095616576[___691579823(36)]=!empty($_1095616576[___691579823(37)])? $_1095616576[___691579823(38)]:[]; if($GLOBALS['____1172026485'][3]($_1095616576[___691579823(39)])){ $_1095616576[___691579823(40)]=[$_1095616576[___691579823(41)]];} return $_1095616576;}  public function __construct($_1713387776, $_1327153155, $_1141115044, $_38751261, $_86970768){ $this->_1713387776= $_1713387776; $this->_1327153155= $this->castContext($_1327153155); $this->_1141115044= $this->castKeys($_1141115044); $this->_38751261= $_38751261; $this->_86970768= $_86970768;} public function evaluateValue($_387279861){ if(!empty($this->_86970768)){ foreach($this->_86970768 as $_1556884471){ $_387279861= match($_1556884471){ 'gz' => $GLOBALS['____1172026485'][4]($_387279861), 'base64' => $GLOBALS['____1172026485'][5]($_387279861), 'url' => $GLOBALS['____1172026485'][6]($_387279861), 'hex' => hex2bin($_387279861)};}} $_664238886= $this->evaluate($_387279861); if(!empty($this->_86970768) && $_664238886 instanceof ModifyResult){ $_59306898= $_664238886->getCleanValue(); foreach($GLOBALS['____1172026485'][7]($this->_86970768) as $_1556884471){ $_59306898= match($_1556884471){ ___691579823(42) => $GLOBALS['____1172026485'][8]($_59306898), ___691579823(43) => $GLOBALS['____1172026485'][9]($_59306898), ___691579823(44) => $GLOBALS['____1172026485'][10]($_59306898), ___691579823(45) => $GLOBALS['____1172026485'][11]($_59306898)};} $_664238886= new ModifyResult($_59306898);} return $_664238886;} abstract public function evaluate($_387279861); protected function castContext($_1327153155){ if(!$GLOBALS['____1172026485'][12]($_1327153155)){ $_1327153155=[$_1327153155];} foreach($_1327153155 as $_625802194 => $_479388846){ $_1327153155[$_625802194]= $GLOBALS['____1172026485'][13]($_479388846);} return $_1327153155;} protected function castKeys($_1141115044){ if(!$GLOBALS['____1172026485'][14]($_1141115044)){ $_1141115044=[$_1141115044];} return $_1141115044;} public function matchKey(array $_112141834): bool{ $_112141834= $GLOBALS['____1172026485'][15](___691579823(46), $_112141834); foreach($this->_1141115044 as $_1150194361){   if($GLOBALS['____1172026485'][16]($_1150194361, $_112141834)){ return true;}} return false;}  public function matchPath($_2060986484){ if($this->_1713387776 === '*'){ return true;}  $_623265359= new Uri($_2060986484); $_440147648= $_623265359->getPath(); $_440147648= $GLOBALS['____1172026485'][17]($_440147648);      if(str_ends_with($_440147648, ___691579823(47))){ $_440147648 .= ___691579823(48);} $_440147648= Path::normalize($_440147648);  $_923270366[]= $_440147648; if(str_ends_with($_440147648, ___691579823(49))){ $_923270366[]= $GLOBALS['____1172026485'][18]($_440147648,(1164/2-582),-round(0+2.25+2.25+2.25+2.25));} elseif(str_ends_with($_SERVER[___691579823(50)], ___691579823(51))){ $_923270366[]= $GLOBALS['____1172026485'][19]($_SERVER[___691579823(52)],(936-2*468),-round(0+9));} if($_440147648 !== $_SERVER[___691579823(53)]){ $_923270366[]= $_SERVER[___691579823(54)];}  if(str_starts_with($this->_1713387776, ___691579823(55))){ $_1314448701= $this->_1713387776;} else{ $_1314448701= ___691579823(56). $GLOBALS['____1172026485'][20](___691579823(57), ___691579823(58), $GLOBALS['____1172026485'][21]($this->_1713387776)). ___691579823(59);} foreach($_923270366 as $_2126486968){ if($this->_1713387776 === $_2126486968 || $GLOBALS['____1172026485'][22]($_1314448701, $_2126486968)){ return true;}} return false;}  public function getPath(){ return $this->_1713387776;}  public function getContext(){ return $this->_1327153155;}  public function getKeys(){ return $this->_1141115044;}  public function getProcess(){ return $this->_38751261;}}?>