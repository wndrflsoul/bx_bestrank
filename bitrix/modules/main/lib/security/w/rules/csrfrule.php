<? namespace Bitrix\Main\Security\W\Rules;if(!function_exists(__NAMESPACE__.'\\___564710372')){function ___564710372($_1355629038){static $_1386359717= false; if($_1386359717 == false) $_1386359717=array('bWFpbg='.'=','T'.'25QY'.'W'.'dlU'.'3Rhc'.'nQ'.'=','U'.'0VDVVJJ'.'VFlf'.'V1dBTE'.'xfRVhJVA='.'=',''.'bW'.'Fpbg'.'='.'=','Y3NyZg='.'=',''.'Y3NyZi'.'B0b2t'.'lbiBp'.'cyBtaXNza'.'W5n','c2VjdXJpdHk=','V1dBTExfRV'.'h'.'JVF'.'9'.'T'.'VFJ'.'JTkc=');return base64_decode($_1386359717[$_1355629038]);}}; use Bitrix\Main\Config\Option; use Bitrix\Main\EventManager; use Bitrix\Main\Security\W\Rules\Results\RuleAction; class CsrfRule extends PregMatchRule{ public function __construct($_241535968, $_478835425, $_1735605279, $_101868150, $_1838205563, $_1627384229){ parent::__construct($_241535968, $_478835425, $_1735605279, $_101868150, $_1838205563, $_1627384229, RuleAction::EXIT);} public function evaluate($_1244526378){ $_784718170= parent::evaluate($_1244526378); if($_784718170 !== true){  EventManager::getInstance()->addEventHandler(___564710372(0), ___564710372(1), function(){ if(!check_bitrix_sessid()){ \CEventLog::log( \CEventLog::SEVERITY_SECURITY, ___564710372(2), ___564710372(3), ___564710372(4), ___564710372(5)); if($_1648512082= Option::get(___564710372(6), ___564710372(7))){ echo $_1648512082;} exit;}});} return true;}}?>